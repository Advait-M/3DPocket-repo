# Author: Advait Maybhate
# Calculating statistics for 3DPocket vs. LIGASITE (experimentally-determined) results

def getStats(list1, list2, total):
    # Using floats to avoid Python 2 integer division issues truncating decimals
    # list1 is actual residues
    # list2 is predicted residues
    # total is total amount of residues

    P = float(len(list1))
    N = float(total - len(list1))

    # Predicted Residues
    TP = float(len(res))
    # Predicted - TP
    FP = float(len(list2)-TP)
    # Actual - TP
    FN = float(len(list1)-TP)
    # Total - TP - FP -FN
    TN = float(total - TP - FP - FN)

    ACC = round((TP + TN)/(P + N), 4)
    SEN = round(TP/P, 4)
    MCC = round((TP*TN-FP*FN)/(((TP+FP) * (TP+FN) * (TN+FP) * (TN+FN))**0.5), 4)
    FPR = round(FP/N, 4)
    return {"FPR": FPR, "ACC":ACC, "MCC":MCC, "SEN":SEN, "FP": FP, "FN":FN, "TN":TN, "TP":TP, "P":P, "N":N}


finalResults = {}

print("2sil")
list1 = [37,38,56,62,63,99,100,121,127,128,129,175,194,205,229,230,231,246,307,309,339,342]
list2 = [16, 17, 19, 36, 37, 38, 41, 43, 44, 47, 56, 60, 62, 63, 70, 72, 81, 82, 83, 84, 85, 87, 88, 97, 99, 100, 103, 105, 108, 112, 114, 115, 120, 121, 126, 127, 128, 129, 131, 137, 142, 143, 144, 145, 147, 151, 157, 159, 173, 175, 180, 181, 182, 183, 194, 204, 205, 208, 215, 227, 228, 229, 230, 231, 232, 234, 236, 241, 244, 246, 248, 251, 252, 269, 278, 282, 284, 285, 286, 288, 293, 307, 309, 317, 331, 338, 339, 340, 341, 342, 345, 346, 347, 348, 349, 350, 355, 357, 361, 362, 363, 364, 365, 507, 510, 515, 516, 517, 521, 525, 530, 531, 535, 536, 541, 543, 544, 546, 550, 556, 557, 565, 566, 570, 571, 572, 573, 574, 575, 576, 582, 584, 586, 588, 590, 592, 594, 601, 602, 603, 606, 609, 617, 618, 623, 631, 632, 637, 641, 642, 652, 654, 655, 663, 664, 674, 685]

res = list(set(list1).intersection(list2))
finalResults["2sil"] = getStats(list1, list2, 576)

print("2cwh")
list1 = [51,53,54,58,126,127,128,129,130,131,148,149,150,151,157,158,166,168,182,183,184,185,186,190,191,192,193,194,236,237,239,240,270,272,307,309,310,311,312,313,314,315]
list2 = [42, 47, 48, 49, 50, 51, 52, 53, 54, 56, 57, 58, 62, 97, 100, 124, 126, 127, 128, 129, 131, 132, 133, 143, 145, 147, 148, 149, 150, 151, 152, 153, 155, 156, 157, 166, 168, 169, 180, 181, 182, 183, 184, 185, 186, 189, 190, 191, 192, 193, 194, 196, 197, 208, 209, 224, 231, 232, 233, 234, 235, 236, 237, 239, 240, 241, 244, 248, 258, 261, 263, 270, 274, 275, 279, 281, 307, 309, 310, 311, 312, 314, 315, 2510, 2520, 2526, 2527, 2529, 2531, 2533, 2536, 2537, 2539, 2540, 2543, 2545, 2547, 2550, 2552, 2554, 2556, 2561, 2565, 2571, 2576, 2579, 2581, 2584, 2595, 2598, 2607, 2608, 2610, 2616, 2645, 2647, 2648, 2662, 2665, 2666, 2670, 2672, 2679, 2693, 2697, 2709, 2733, 2769, 2776, 2777, 2818, 1510, 1520, 1528, 1529, 1533, 1535, 1538, 1539, 1541, 1544, 1546, 1547, 1558, 1560, 1561, 1569, 1570, 1573, 1574, 1576, 1577, 1579, 1580, 1598, 1599, 1601, 1611, 1615, 1619, 1628, 1629, 1632, 1638, 1646, 1647, 1658, 1661, 1663, 1668, 1672, 1675, 1677, 1697, 1710, 1725, 1741, 1777]

res = list(set(list1).intersection(list2))
finalResults["2cwh"] = getStats(list1, list2, 933)

print("3cwk")
list1 = [15,19,24,28,31,32,36,39,41,54,56,58,59,61,76,77,121,123,132,134]
list2 = [7, 12, 15, 19, 24, 32, 36, 39, 40, 41, 42, 52, 54, 55, 56, 58, 59, 61, 63, 73, 74, 75, 76, 77, 96, 97, 99, 105, 107, 108, 109, 110, 111, 120, 121, 123, 124, 132, 300, 401, 402, 406, 408, 410, 413, 414, 420, 422, 425, 430, 432, 441, 449, 450, 453, 462, 481, 494, 516, 579, 587, 589, 609, 612]

res = list(set(list1).intersection(list2))
finalResults["3cwk"] = getStats(list1, list2, 360)

print("3gva")
list1 = [25,39,42,43,45,46,48,49,50,56,59,67,69,70,71,74,75,77,78,81]
list2 = [3, 7, 13, 23, 24, 25, 26, 28, 38, 39, 40, 43, 45, 46, 47, 48, 50, 56, 59, 60, 61, 62, 65, 66, 67, 68, 70, 72, 74, 75, 78, 3186, 3221, 3076, 3110, 3121, 3126, 3128, 3081, 3143, 3083, 3001, 3013, 3017, 3018, 3019, 3020, 3023, 3024, 3026, 3027, 3029, 3033, 3171, 3046, 3047, 3049, 3054, 3068]

res = list(set(list1).intersection(list2))
finalResults["3gva"] = getStats(list1, list2, 228)

print("1lv1")
list1 = [8,23,25,27,28,29,30,32,47,48,49,50,80,81,82,84,1008,1023,1025,1027,1028,1029,1030,1032,1047,1048,1049,1050,1081,1082,1084]
list2 = [3, 8, 9, 10, 11, 14, 21, 23, 25, 26, 27, 28, 29, 30, 31, 32, 45, 47, 48, 49, 50, 51, 62, 63, 74, 81, 82, 83, 84, 87, 88, 1041, 1045, 1027, 1047, 1048, 1049, 409, 1050, 1028, 1029, 1058, 1060, 1030, 1062, 1063, 1031, 428, 1074, 1025, 1081, 1082, 1083, 1084, 1087, 1088, 439, 406, 410, 412, 417, 419, 420, 425, 430, 413, 437, 438, 448, 1007, 1008, 1010, 1014, 1021, 1023]

res = list(set(list1).intersection(list2))
finalResults["1lv1"] = getStats(list1, list2, 253)

print("3h2g")
list1 =[87,88,138,139,175,176,177,208,214,215,218,219,221,228,230,231,232,233,234,235,239,275,276,279,280,287,290,294,299,310,338,339,375,377,378,379]
list2 = [65, 84, 85, 86, 87, 88, 89, 90, 94, 96, 99, 100, 107, 108, 109, 124, 125, 126, 136, 137, 138, 139, 141, 143, 145, 172, 173, 175, 176, 177, 182, 184, 186, 206, 207, 208, 209, 214, 215, 219, 228, 230, 231, 233, 234, 235, 275, 276, 294, 328, 331, 332, 333, 336, 338, 339, 340, 341, 344, 364, 377, 378, 381, 382, 383, 429, 481, 482, 484, 485, 491, 509, 513, 518, 532, 533, 534, 535, 537, 539, 541, 545, 548, 549, 551, 559, 560, 593, 599, 615, 619, 639, 652, 671, 674, 692, 726, 798, 825, 835, 915, 917]

res = list(set(list1).intersection(list2))
finalResults["3h2g"] = getStats(list1, list2, 916)

print("3i3i")
list1 = [2,3,4,5,6,7,9,10,11,15,17,18,19,21,22,23,27,28,29,30,31,32,44,45,47,48,49,51,52,60,68,69,75,76,77,92,96,102,106,121,122,123,125]
list2 = [2, 3, 4, 5, 6, 7, 9, 11, 12, 14, 18, 19, 21, 22, 23, 24, 26, 28, 29, 30, 31, 32, 33, 34, 36, 37, 40, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 56, 57, 58, 62, 63, 65, 67, 68, 69, 73, 75, 76, 77, 78, 80, 81, 83, 84, 85, 86, 87, 90, 91, 93, 94, 97, 98, 100, 101, 102, 104, 105, 107, 120, 122, 126, 127, 129, 130, 131, 133, 146, 161, 171, 179, 187, 188, 195, 205, 215, 240, 242, 254, 261, 262, 263, 266, 267, 270, 273, 275, 276, 280, 281, 282, 284, 285, 286, 287, 288, 290, 294, 295, 296, 298, 299, 300, 302, 306, 309, 313, 317, 320, 321, 325, 332, 335, 339, 343, 344, 348, 349, 353, 361]

res = list(set(list1).intersection(list2))
finalResults["3i3i"] = getStats(list1, list2, 381)


ACCT = 0
SENT = 0
MCCT = 0
FPRT = 0
for i in finalResults.keys():
    print(i, finalResults[i])
    ACCT += finalResults[i]["ACC"]
    SENT += finalResults[i]["SEN"]
    MCCT += finalResults[i]["MCC"]
    FPRT += finalResults[i]["FPR"]
amount = len(finalResults.keys())
averages = {"MCC": round(MCCT/amount, 4), "ACC": round(ACCT/amount, 4), "SEN": round(SENT/amount, 4), "FPR": round(FPRT/amount, 4)}
print(averages)